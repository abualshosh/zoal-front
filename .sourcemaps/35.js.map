{"version":3,"sources":["../../src/pages/tabs/tabs.module.ts","../../src/pages/pages.ts","../../src/pages/tabs/tabs.ts"],"names":[],"mappings":"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","file":"35.js","sourcesContent":["import { NgModule } from '@angular/core';\r\nimport { TranslateModule } from '@ngx-translate/core';\r\nimport { IonicPageModule } from 'ionic-angular';\r\n\r\nimport { TabsPage } from './tabs';\r\n\r\n@NgModule({\r\n  declarations: [\r\n    TabsPage,\r\n  ],\r\n  imports: [\r\n    \r\n    IonicPageModule.forChild(TabsPage),\r\n    TranslateModule.forChild()\r\n  ],\r\n  exports: [\r\n    TabsPage\r\n  ]\r\n})\r\nexport class TabsPageModule { }\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/tabs/tabs.module.ts","// The page the user lands on after opening the app and without a session\r\nexport const FirstRunPage = 'TutorialPage';\r\n\r\n// The main page the user will see as they use the app over a long period of time.\r\n// Change this if not using tabs\r\nexport const MainPage = 'TabsPage';\r\n\r\n// The initial root pages for our tabs (remove if not using tabs)\r\nexport const Tab1Root = 'FeedsPage';\r\nexport const Tab2Root = 'SearchPage';\r\nexport const Tab3Root = 'SettingsPage';\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/pages.ts","import { Component ,ViewChild,NgZone} from '@angular/core';\r\nimport { TranslateService } from '@ngx-translate/core';\r\nimport { IonicPage, NavController,Events } from 'ionic-angular';\r\nimport { Api } from '../../providers/providers';\r\nimport { Tab1Root } from '../pages';\r\nimport { Tab2Root } from '../pages';\r\nimport { Tab3Root } from '../pages';\r\nimport { StompService } from 'ng2-stomp-service';\r\nimport { SQLite ,SQLiteObject  } from '@ionic-native/sqlite';\r\nimport { FCM } from '@ionic-native/fcm';\r\nimport { Platform } from 'ionic-angular';\r\nimport { Contacts, Contact, ContactField, ContactName } from '@ionic-native/contacts';\r\n\r\n\r\n\r\n@IonicPage()\r\n@Component({\r\n  selector: 'page-tabs',\r\n  templateUrl: 'tabs.html'\r\n})\r\nexport class TabsPage {\r\n  username:any;\r\n  tab1Root: any = 'FeedsPage';\r\n  tab2Root: any = Tab2Root;\r\n  tab3Root: any = 'ContentPage';\r\n  tab4Root: any = 'ChatsPage';\r\n    tab5Root: any = 'SlideFreeModePage';\r\n  tab1Title :any;\r\n  tab2Title  :any;\r\n  tab3Title  :any;\r\n  tab4Title  :any;\r\n  tab5Title :any;\r\n  tab4BadgeCount =0;\r\n  upcontacts:any=[];\r\n  currentItems: any = [];\r\nsubscription:any;\r\n\r\n  constructor(private contacts: Contacts,public zone:NgZone,public platform: Platform,private fcm: FCM,public sqlite:SQLite,public api: Api,public events: Events,public stomp: StompService,public navCtrl: NavController, public translateService: TranslateService) {\r\n    translateService.get(['feeds', 'Contacts', 'profile','chat', 'Pay']).subscribe(values => {\r\n     // alert(\"ds\");\r\n      this.tab1Title = values['feeds'];\r\n      this.tab2Title = values['Contacts'];\r\n      this.tab3Title = values['profile'];\r\n      this.tab4Title = values['chat'];\r\n      this.tab5Title = values['Pay'];\r\n    });\r\n  \r\n    platform.ready().then(() => {  \r\n    if (this.platform.is('cordova')) {\r\nthis.initDatabase();\r\n\r\nthis.username=localStorage.getItem('username');\r\nthis.uploadContacts();\r\n    if(typeof fcm === \"undefined\"){\r\n      alert(\"FCMPlugin is installed correctly\");\r\n    }\r\n  fcm.getToken().then(token=>{\r\n   if(token){\r\n    localStorage.setItem('FCMToken',token)\r\n    this.connectWs(localStorage.getItem('id_token'),token);\r\n   } })\r\n  \r\n  fcm.onNotification().subscribe(data=>{\r\n\r\n    if(data.wasTapped){\r\n      alert(JSON.stringify(data));\r\n    } else {\r\n    \r\n     // alert(\"Received in foreground\");\r\n    };\r\n  })\r\n  \r\n  fcm.onTokenRefresh().subscribe(token=>{\r\n    if(token){\r\n      \r\n    localStorage.setItem('FCMToken',token);\r\n   this.connectWs(localStorage.getItem('id_token'),token);\r\n   \r\n  }})\r\n}else{\r\n this.connectWs(localStorage.getItem('id_token'),null);\r\n \r\n}\r\n           });\r\n  }\r\n\r\n  initDatabase(){\r\n    this.sqlite.create({\r\n      name: localStorage.getItem('username'),\r\n      location: 'default'\r\n    })\r\n      .then((db: SQLiteObject) => {\r\n  \r\n    this.createTables(db);\r\n  \r\n      })\r\n      .catch(e => console.log(e));\r\n  }\r\n  \r\n  createTables(db: SQLiteObject){\r\n          db.executeSql(`CREATE TABLE IF NOT EXISTS messages(\r\n               ID INTEGER PRIMARY KEY AUTOINCREMENT,\r\n               chatId INTEGER,\r\n               otherUser TEXT,\r\n               msg TEXT,\r\n               msgDate DateTime\r\n               \r\n          )`, []);\r\n          db.executeSql(`CREATE TABLE IF NOT EXISTS chats(\r\n               ID INTEGER PRIMARY KEY AUTOINCREMENT,\r\n               otherUser TEXT,\r\n               msg TEXT,\r\n               msgDate DateTime\r\n          )`, []);\r\n  \r\n          // db.executeSql(`insert into chats(\r\n          //              otherUser ,\r\n          //              msg ,\r\n          //              msgDate\r\n          //         ) values (?,?,?)`, ['user','first m','2017-11-11']);\r\n  \r\n      }\r\n  \r\n\r\n\r\n\r\n  connectWs(token:any,FcmToken:any) {\r\n    //configuration\r\n    this.stomp.configure({\r\n      host:'https://'+this.api.urlip+'/websocket/tracker?access_token='+token+'&FcmToken='+localStorage.getItem('FCMToken'),\r\n      headers:{\r\n        Authorization: `Bearer ${token}`,\r\n        FcmToken: localStorage.getItem('FCMToken')\r\n      },\r\n      \r\n      debug:true,\r\n      queue:{'init':false}\r\n    });\r\n    \r\n    //start connection\r\n    this.stomp.startConnect().then(() => {\r\n      this.stomp.done('init');\r\n      console.log('connected');\r\n\r\n      //subscribe\r\n      this.subscription = this.stomp.subscribe('/user/queue/messages', this.response);\r\n      //send data\r\n      this.events.subscribe('message', (greeting) => {\r\nconsole.log(greeting)\r\nthis.zone.run(() => {\r\n  this.tab4BadgeCount++;\r\n  });\r\n        this.sqlite.create({\r\n          name: localStorage.getItem('username'),\r\n          location: 'default'\r\n        })\r\n          .then((db: SQLiteObject) => {\r\n         db.executeSql(`insert into messages(\r\n             chatId ,\r\n             otherUser ,\r\n             msg ,\r\n             msgDate\r\n        ) values (?,?,?,?)`, [greeting.sender,greeting.sender,greeting.message,greeting.msgDate]);\r\n\r\n\r\n        db.executeSql(`update chats set msg=? , msgDate=? where otheruser=?`,\r\n           [greeting.message,greeting.msgDate,greeting.sender]).then(data => {\r\n          if(data.rowsAffected == 0){\r\n            db.executeSql(`insert into chats(\r\n              otherUser ,\r\n              msg ,\r\n              msgDate\r\n         ) values (?,?,?)`, [greeting.sender,greeting.message,greeting.msgDate]);\r\n         \r\n          }\r\n            }, (e) => {\r\n        \r\n             \r\n            console.log(\"Errot: \" + JSON.stringify(e));\r\n            });\r\n\r\n           // for(var i = 0; i < this.chats.length; i++)\r\n           // {\r\n           //   if(this.chats[i].title==greeting.sender){\r\n           //     this.chats[i].lastMessage=greeting.message;\r\n           //     this.chats[i].timestamp=new Date();\r\n           //   }\r\n           // }\r\n\r\n      })\r\n      .catch(e => console.log(e));\r\n      });\r\n\r\n      //unsubscribe\r\n  //    this.subscription.unsubscribe();\r\n\r\n      //disconnect\r\n  //    this.stomp.disconnect().then(() => {\r\n//        console.log( 'Connection closed' )\r\n//      })\r\n\r\n    });\r\n\r\n\r\n  }\r\n\r\n  uploadContacts(){\r\n    var opts = {\r\n             filter : \"M\",\r\n             multiple: true,\r\n             hasPhoneNumber:true,\r\n             fields:  [ 'displayName', 'name' ]\r\n           };\r\n  \r\n           this.contacts.find([ '*' ],opts).then((contacts) => {\r\n             for(var i=0;i<contacts.length;i++){\r\n               let cont=contacts[i].phoneNumbers[0].value;\r\n              contacts[i].phoneNumbers[0].value= cont.replace(/ /g,'').trim().slice(-9);\r\n              this.upcontacts.push({\"login\":contacts[i].phoneNumbers[0].value});\r\n            }\r\n  \r\n  \r\n  \r\n            let seq = this.api.post('connections',this.upcontacts).share();\r\n        //    this.posts=this.postsTest;\r\n             seq.subscribe((res: any) => {\r\n               // If the API returned a successful response, mark the user as logged in\r\n               if (res) {\r\n                     this.currentItems=[];\r\n                 for (var i=0;i<res.length;i++){\r\n                   if(res[i].profileOne.userName!=this.username){\r\n                      this.currentItems.push(res[i].profileOne);\r\n                   }else if(res[i].profileTow.userName!=this.username){\r\n                     this.currentItems.push(res[i].profileTow);\r\n                   }\r\n                 }\r\n                 localStorage.setItem(\"connections\", JSON.stringify(this.currentItems));\r\n                } \r\n             }, err => {\r\n                console.error('ERROR', err);\r\n             });\r\n             }, (error) => {\r\n             console.log(error);\r\n           });\r\n  }\r\n\r\n  public response = (data) => {\r\nconsole.log(data)\r\n     this.events.publish('message', data);\r\n  }\r\n  @ViewChild('myTabs') tabRef: any;\r\n\r\n  selectTab() {\r\n    this.tabRef.select(2);\r\n  }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/tabs/tabs.ts"],"sourceRoot":""}