{"version":3,"sources":["../../src/pages/chat/chats.module.ts","../../src/pages/chat/chats.ts"],"names":[],"mappings":"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","file":"57.js","sourcesContent":["// import { SharedModule } from '../../../app/shared.module';\r\nimport { ChatsPage } from './chats';\r\nimport { NgModule } from '@angular/core';\r\nimport { IonicPageModule } from 'ionic-angular';\r\nimport { TranslateModule } from '@ngx-translate/core';\r\n\r\n@NgModule({\r\n  declarations: [\r\n    ChatsPage,\r\n  ],\r\n  imports: [\r\n    IonicPageModule.forChild(ChatsPage),\r\n    TranslateModule.forChild()\r\n  //  SharedModule\r\n  ],\r\n  exports: [\r\n    ChatsPage\r\n  ]\r\n})\r\n\r\nexport class ChatsPageModule { }\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/chat/chats.module.ts","import { Component } from '@angular/core';\r\nimport { NavController, IonicPage,ModalController } from 'ionic-angular';\r\nimport { SQLite ,SQLiteObject  } from '@ionic-native/sqlite';\r\nimport { Api } from '../../providers/providers'\r\nimport { Events } from 'ionic-angular';\r\n\r\n@IonicPage()\r\n@Component({\r\n  templateUrl: 'chats.html',\r\n})\r\n\r\n\r\nexport class ChatsPage {\r\n  public messageForm: any;\r\n  chats = [];\r\n  messages:any=[];\r\nconstructor(public modalCtrl: ModalController,public events: Events,public api:Api,public sqlite:SQLite,public navCtrl: NavController) {\r\n  \r\n  this.chats.push({\r\n    imageUrl: this.api.url+'/profileimage/'+\"249922190200\",\r\n    title: \"249922190200\",\r\n    lastMessage: \"s\",\r\n    timestamp:\"\"\r\n  });\r\n    this.events.subscribe('sending', (msgData) => {\r\n      var found=false;\r\n      for(var i = 0; i < this.chats.length; i++)\r\n      {\r\n         if(this.chats[i].title==msgData.username){\r\n           found=true;\r\n          this.chats[i].lastMessage=msgData.text;\r\n         }\r\n      }\r\n      if(!found){\r\n        this.chats.push({\r\n          imageUrl: this.api.url+'/profileimage/'+msgData.username,\r\n          title: msgData.username,\r\n          lastMessage: msgData.text,\r\n          timestamp: msgData.date\r\n        });\r\n      }\r\n    });\r\n    this.events.subscribe('message', (greeting) => {\r\n    var add=false;\r\n      for(var i = 0; i < this.chats.length; i++)\r\n      {\r\n         if(this.chats[i].title==greeting.sender){\r\n          this.chats[i].lastMessage=greeting.message;\r\n          this.chats[i].timestamp=greeting.msgData;\r\n          add=true; \r\n        }\r\n      }\r\n\r\n      if(!add){\r\n        this.chats.push({\r\n          imageUrl: this.api.url+'/profileimage/'+greeting.sender,\r\n          title: greeting.sender,\r\n          lastMessage: greeting.message,\r\n          timestamp: greeting.msgoy\r\n       \r\n        });\r\n      }\r\n\r\n    });\r\n\r\n\r\n\r\n    this.sqlite.create({\r\n      name: localStorage.getItem('username'),\r\n      location: 'default'\r\n    })\r\n      .then((db: SQLiteObject) => {\r\n\r\n    db.executeSql(\"SELECT * FROM chats\", []).then(data => {\r\n       // this.items = [];\r\n\r\n        if(data.rows.length > 0) {\r\n            for(var i = 0; i < data.rows.length; i++)\r\n            {\r\n\r\n            this.chats.push({\r\n                imageUrl: this.api.url+'/profileimage/'+data.rows.item(i).otherUser,\r\n                title: data.rows.item(i).otherUser,\r\n                lastMessage: data.rows.item(i).msg,\r\n                timestamp: data.rows.item(i).msgDate\r\n              });\r\n\r\n       //         this.items.push(data.rows.item(i));\r\n            }\r\n        }\r\n    }, (e) => {\r\n\r\n\r\n        console.log(\"Errot: \" + JSON.stringify(e));\r\n    });\r\n\r\n      })\r\n      .catch(e => console.log(e));\r\n\r\n\r\n  }\r\n\r\nselectNew(){\r\n  let profileModal = this.modalCtrl.create('SelectUserPage');\r\n   profileModal.onDidDismiss(data => {\r\n\r\nif (data){\r\n \r\nthis.viewMessages({\"title\":data});\r\n          }\r\n   });\r\n   profileModal.present();\r\n\r\n\r\n\r\n\r\n}\r\n  viewMessages(chat) {\r\n    this.messages=[];\r\n    this.sqlite.create({\r\n      name: localStorage.getItem('username'),\r\n      location: 'default'\r\n    })\r\n      .then((db: SQLiteObject) => {\r\n    db.executeSql(\"SELECT * FROM messages where chatid=? order by id DESC limit ? \", [chat.title,10]).then(data => {\r\n    if(data.rows.length > 0) {\r\n      for(var i = data.rows.length-1; i >= 0; i--)\r\n      {\r\n\r\n        this.messages.push({\r\n          toId: data.rows.item(i).otherUser,\r\n          _id: 6,\r\n          date: data.rows.item(i).msgDate,\r\n          userId: data.rows.item(i).otherUser,\r\n          username: data.rows.item(i).otherUser,\r\n          pic: this.api.url+'/profileimage/'+data.rows.item(i).otherUser,\r\n          text: data.rows.item(i).msg    });\r\n\r\n      }\r\n\r\n    }\r\n  this.navCtrl.push('MessagesPage', { otherUser : chat.title, msg :this.messages });\r\n    }, (e) => {\r\n\r\n\r\n    console.log(\"Errot: \" + JSON.stringify(e));\r\n    });\r\n  })\r\n  .catch(e => \r\n    this.navCtrl.push('MessagesPage', { otherUser : chat.title, msg :this.messages })\r\n  );\r\n  }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/chat/chats.ts"],"sourceRoot":""}